@model GarageManagementSystem.IdentityServer.Controllers.CreateClientViewModel

<input type="hidden" id="editClientDbId" value="@ViewBag.ClientId" />

<form id="editClientForm">
    <!-- Basic Information -->
    <div class="row">
        <div class="col-md-12">
            <h6 class="text-primary mb-3"><i class="fas fa-info-circle"></i> Basic Information</h6>
        </div>
    </div>
    <div class="row">
        <div class="col-md-6">
            <div class="form-group">
                <label for="editClientIdInput">Client ID <span class="text-danger">*</span></label>
                <input type="text" class="form-control form-control-sm" id="editClientIdInput" name="ClientId" value="@Model.ClientId" required readonly>
                <small class="form-text text-muted">Unique identifier for your client application (read-only)</small>
            </div>
        </div>
        <div class="col-md-6">
            <div class="form-group">
                <label for="editClientNameInput">Client Name <span class="text-danger">*</span></label>
                <input type="text" class="form-control form-control-sm" id="editClientNameInput" name="ClientName" value="@Model.ClientName" required>
                <small class="form-text text-muted">Display name for this client</small>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <div class="form-group">
                <label for="editDescription">Description</label>
                <textarea class="form-control form-control-sm" id="editDescription" name="Description" rows="2">@Model.Description</textarea>
                <small class="form-text text-muted">Helpful description for administration</small>
            </div>
        </div>
    </div>
    </div>

    <!-- Security Settings -->
    <div class="row">
        <div class="col-md-12">
            <h6 class="text-primary mb-3"><i class="fas fa-shield-alt"></i> Security Settings</h6>
        </div>
    </div>
    <div class="row">
        <div class="col-md-6">
            <div class="form-group">
                <label for="editProtocolType">Protocol Type</label>
                <select class="form-control form-control-sm" id="editProtocolType" name="ProtocolType">
                    @if (Model.ProtocolType == "oidc")
                    {
                        <option value="oidc" selected>OpenID Connect</option>
                        <option value="oauth2">OAuth 2.0</option>
                        <option value="wsfed">WS-Federation</option>
                        <option value="saml2p">SAML 2.0</option>
                    }
                    else if (Model.ProtocolType == "oauth2")
                    {
                        <option value="oidc">OpenID Connect</option>
                        <option value="oauth2" selected>OAuth 2.0</option>
                        <option value="wsfed">WS-Federation</option>
                        <option value="saml2p">SAML 2.0</option>
                    }
                    else if (Model.ProtocolType == "wsfed")
                    {
                        <option value="oidc">OpenID Connect</option>
                        <option value="oauth2">OAuth 2.0</option>
                        <option value="wsfed" selected>WS-Federation</option>
                        <option value="saml2p">SAML 2.0</option>
                    }
                    else if (Model.ProtocolType == "saml2p")
                    {
                        <option value="oidc">OpenID Connect</option>
                        <option value="oauth2">OAuth 2.0</option>
                        <option value="wsfed">WS-Federation</option>
                        <option value="saml2p" selected>SAML 2.0</option>
                    }
                    else
                    {
                        <option value="oidc" selected>OpenID Connect</option>
                        <option value="oauth2">OAuth 2.0</option>
                        <option value="wsfed">WS-Federation</option>
                        <option value="saml2p">SAML 2.0</option>
                    }
                </select>
                <small class="form-text text-muted">Choose authentication protocol</small>
            </div>
        </div>
        <div class="col-md-6">
            <div class="form-group">
                <label for="editClientSecret">Client Secret</label>
                <input type="password" class="form-control form-control-sm" id="editClientSecret" name="ClientSecret" placeholder="Enter new secret">
                <small class="form-text text-muted">Leave blank to keep current secret</small>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <div class="form-group">
                <label class="font-weight-bold">Security Options</label>
                <div class="row">
                    <div class="col-md-3">
                        <div class="custom-control custom-switch">
                            <input type="checkbox" class="custom-control-input" id="editEnabled" name="Enabled" value="true" @(Model.Enabled ? "checked" : "")>
                            <input type="hidden" name="Enabled" value="false" />
                            <label class="custom-control-label" for="editEnabled">Enabled</label>
                        </div>
                        <div class="custom-control custom-switch">
                            <input type="checkbox" class="custom-control-input" id="editRequireClientSecret" name="RequireClientSecret" value="true" @(Model.RequireClientSecret ? "checked" : "")>
                            <input type="hidden" name="RequireClientSecret" value="false" />
                            <label class="custom-control-label" for="editRequireClientSecret">Require Client Secret</label>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="custom-control custom-switch">
                            <input type="checkbox" class="custom-control-input" id="editRequirePkce" name="RequirePkce" value="true" @(Model.RequirePkce ? "checked" : "")>
                            <input type="hidden" name="RequirePkce" value="false" />
                            <label class="custom-control-label" for="editRequirePkce">Require PKCE</label>
                        </div>
                        <div class="custom-control custom-switch">
                            <input type="checkbox" class="custom-control-input" id="editAllowOfflineAccess" name="AllowOfflineAccess" value="true" @(Model.AllowOfflineAccess ? "checked" : "")>
                            <input type="hidden" name="AllowOfflineAccess" value="false" />
                            <label class="custom-control-label" for="editAllowOfflineAccess">Allow Offline Access</label>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="custom-control custom-switch">
                            <input type="checkbox" class="custom-control-input" id="editIncludeJwtId" name="IncludeJwtId" value="true" @(Model.IncludeJwtId ? "checked" : "")>
                            <input type="hidden" name="IncludeJwtId" value="false" />
                            <label class="custom-control-label" for="editIncludeJwtId">Include JWT ID</label>
                        </div>
                        <div class="custom-control custom-switch">
                            <input type="checkbox" class="custom-control-input" id="editRequireConsent" name="RequireConsent" value="true" @(Model.RequireConsent ? "checked" : "")>
                            <input type="hidden" name="RequireConsent" value="false" />
                            <label class="custom-control-label" for="editRequireConsent">Require Consent</label>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="custom-control custom-switch">
                            <input type="checkbox" class="custom-control-input" id="editAllowRememberConsent" name="AllowRememberConsent" value="true" @(Model.AllowRememberConsent ? "checked" : "")>
                            <input type="hidden" name="AllowRememberConsent" value="false" />
                            <label class="custom-control-label" for="editAllowRememberConsent">Allow Remember Consent</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-6">
            <div class="form-group">
                <label for="editAccessTokenLifetime">Access Token Lifetime (seconds)</label>
                <input type="number" class="form-control form-control-sm" id="editAccessTokenLifetime" name="AccessTokenLifetime" value="@Model.AccessTokenLifetime">
            </div>
            <div class="form-group">
                <label for="editIdentityTokenLifetime">Identity Token Lifetime (seconds)</label>
                <input type="number" class="form-control form-control-sm" id="editIdentityTokenLifetime" name="IdentityTokenLifetime" value="@Model.IdentityTokenLifetime">
            </div>
        </div>
        <div class="col-md-6">
            <div class="form-group">
                <label for="editAuthorizationCodeLifetime">Authorization Code Lifetime (seconds)</label>
                <input type="number" class="form-control form-control-sm" id="editAuthorizationCodeLifetime" name="AuthorizationCodeLifetime" value="@Model.AuthorizationCodeLifetime">
            </div>
            <div class="form-group">
                <label for="editUserSsoLifetime">User SSO Lifetime (seconds)</label>
                <input type="number" class="form-control form-control-sm" id="editUserSsoLifetime" name="UserSsoLifetime" value="@Model.UserSsoLifetime">
            </div>
        </div>
    </div>

    <!-- Authentication -->
    <div class="row">
        <div class="col-md-12">
            <h6 class="text-primary mb-3"><i class="fas fa-key"></i> Authentication</h6>
        </div>
    </div>
    <div class="row">
        <div class="col-md-6">
            <div class="form-group">
                <label for="editGrantTypes">Grant Types</label>
                <select class="form-control form-control-sm select2" style="width: 100%;" id="editGrantTypes" name="GrantTypes" multiple data-selected-values="@(Model.AllowedGrantTypes != null ? string.Join(",", Model.AllowedGrantTypes) : "")">
                    <!-- Dynamic options will be loaded -->
                </select>
            </div>
        </div>
        <div class="col-md-6">
            <div class="form-group">
                <label for="editScopes">Scopes</label>
                <select class="form-control form-control-sm select2" style="width: 100%;" id="editScopes" name="Scopes" multiple data-selected-values="@(Model.AllowedScopes != null ? string.Join(",", Model.AllowedScopes) : "")">
                    <!-- Dynamic options will be loaded -->
                </select>
            </div>
        </div>
    </div>


    <!-- URLs Configuration -->
    <div class="row">
        <div class="col-md-12">
            <h6 class="text-primary mb-3"><i class="fas fa-globe"></i> URLs Configuration</h6>
        </div>
    </div>
    <div class="row">
        <div class="col-md-6">
            <div class="form-group">
                <label for="editRedirectUris">Redirect URIs</label>
                <textarea class="form-control form-control-sm" id="editRedirectUris" name="RedirectUris" rows="4">@(Model.RedirectUris != null ? string.Join("\n", Model.RedirectUris) : "")</textarea>
                <small class="form-text text-muted">One URI per line</small>
            </div>
        </div>
        <div class="col-md-6">
            <div class="form-group">
                <label for="editPostLogoutRedirectUris">Post Logout URIs</label>
                <textarea class="form-control form-control-sm" id="editPostLogoutRedirectUris" name="PostLogoutRedirectUris" rows="4">@(Model.PostLogoutRedirectUris != null ? string.Join("\n", Model.PostLogoutRedirectUris) : "")</textarea>
                <small class="form-text text-muted">One URI per line</small>
            </div>
        </div>
        <div class="col-md-12">
            <div class="form-group">
                <label for="editAllowedCorsOrigins">Allowed CORS Origins</label>
                <textarea class="form-control form-control-sm" id="editAllowedCorsOrigins" name="AllowedCorsOrigins" rows="3">@(Model.AllowedCorsOrigins != null ? string.Join("\n", Model.AllowedCorsOrigins) : "")</textarea>
                <small class="form-text text-muted">One origin per line</small>
            </div>
        </div>
    </div>

    <!-- Advanced Settings -->
    <div class="row">
        <div class="col-md-6">
            <h6 class="text-primary mb-3"><i class="fas fa-cogs"></i> Advanced Settings</h6>
        </div>
        <!-- Client Claims Section -->
        <div class="col-6">
            <h6 class="text-primary mb-3"><i class="fas fa-cogs"></i> Client Claims</h6>
        </div>
    </div>
    <div class="row">
        <div class="col-md-6">
            <div class="form-group">
                <div class="custom-control custom-switch">
                    <input type="checkbox" class="custom-control-input" id="editRequireRequestObject" name="RequireRequestObject" value="true" @(Model.RequireRequestObject ? "checked" : "")>
                    <input type="hidden" name="RequireRequestObject" value="false" />
                    <label class="custom-control-label" for="editRequireRequestObject">Require Request Object</label>
                </div>
                <div class="custom-control custom-switch">
                    <input type="checkbox" class="custom-control-input" id="editFrontChannelLogoutSessionRequired" name="FrontChannelLogoutSessionRequired" value="true" @(Model.FrontChannelLogoutSessionRequired ? "checked" : "")>
                    <input type="hidden" name="FrontChannelLogoutSessionRequired" value="false" />
                    <label class="custom-control-label" for="editFrontChannelLogoutSessionRequired">Front Channel Logout Session Required</label>
                </div>
                <div class="custom-control custom-switch">
                    <input type="checkbox" class="custom-control-input" id="editBackChannelLogoutSessionRequired" name="BackChannelLogoutSessionRequired" value="true" @(Model.BackChannelLogoutSessionRequired ? "checked" : "")>
                    <input type="hidden" name="BackChannelLogoutSessionRequired" value="false" />
                    <label class="custom-control-label" for="editBackChannelLogoutSessionRequired">Back Channel Logout Session Required</label>
                </div>
                <div class="custom-control custom-switch">
                    <input type="checkbox" class="custom-control-input" id="editAllowAccessTokensViaBrowser" name="AllowAccessTokensViaBrowser" value="true" @(Model.AllowAccessTokensViaBrowser ? "checked" : "")>
                    <input type="hidden" name="AllowAccessTokensViaBrowser" value="false" />
                    <label class="custom-control-label" for="editAllowAccessTokensViaBrowser">Allow Access Tokens via Browser</label>
                </div>
                <div class="custom-control custom-switch">
                    <input type="checkbox" class="custom-control-input" id="editUpdateAccessTokenClaimsOnRefresh" name="UpdateAccessTokenClaimsOnRefresh" value="true" @(Model.UpdateAccessTokenClaimsOnRefresh ? "checked" : "")>
                    <input type="hidden" name="UpdateAccessTokenClaimsOnRefresh" value="false" />
                    <label class="custom-control-label" for="editUpdateAccessTokenClaimsOnRefresh">Update Access Token Claims on Refresh</label>
                </div>
                <div class="custom-control custom-switch">
                    <input type="checkbox" class="custom-control-input" id="editAlwaysSendClientClaims" name="AlwaysSendClientClaims" value="true" @(Model.AlwaysSendClientClaims ? "checked" : "")>
                    <input type="hidden" name="AlwaysSendClientClaims" value="false" />
                    <label class="custom-control-label" for="editAlwaysSendClientClaims">Always Send Client Claims</label>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="form-group">
                <label for="editClientClaims">Select Claims</label>
                <select id="editClientClaims" name="SelectedClaims" class="form-control" multiple 
                        data-selected-values="@string.Join(",", Model.SelectedClaims)">
                    <!-- Options will be loaded dynamically -->
                </select>
                <small class="form-text text-muted">Select claims that this client will receive</small>
            </div>
            <div id="editClientClaimsContainer">
                <!-- Dynamic claims will be added here -->
            </div>
            <div class="form-group">
                <label for="editClientClaimsPrefix">Client Claims Prefix</label>
                <input type="text" class="form-control form-control-sm" id="editClientClaimsPrefix" name="ClientClaimsPrefix" value="@Model.ClientClaimsPrefix" placeholder="client_">
                <small class="form-text text-muted">Prefix for client claims</small>
            </div>
        </div>
    </div>
    
    
    
    <div class="row">
        <div class="col-md-6">
            <div class="form-group">
                <label for="editFrontChannelLogoutUri">Front Channel Logout URI</label>
                <input type="url" class="form-control form-control-sm" id="editFrontChannelLogoutUri" name="FrontChannelLogoutUri" value="@Model.FrontChannelLogoutUri" placeholder="https://example.com/logout">
            </div>
        </div>
        <div class="col-md-6">
            <div class="form-group">
                <label for="editBackChannelLogoutUri">Back Channel Logout URI</label>
                <input type="url" class="form-control form-control-sm" id="editBackChannelLogoutUri" name="BackChannelLogoutUri" value="@Model.BackChannelLogoutUri" placeholder="https://example.com/backchannel-logout">
            </div>
        </div>
    </div>
    </div>

    <div class="modal-footer">
        <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">Cancel</button>
        <button type="submit" class="btn btn-primary btn-sm">Update Client</button>
    </div>
</form>