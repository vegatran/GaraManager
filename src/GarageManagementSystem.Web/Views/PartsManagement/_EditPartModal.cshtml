<!-- Edit Part Modal with Classification -->
<div class="modal fade" id="editPartModal" tabindex="-1" role="dialog" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content">
            <div class="modal-header bg-info text-white">
                <h4 class="modal-title"><i class="fas fa-edit"></i> C·∫≠p Nh·∫≠t Ph·ª• T√πng</h4>
                <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <form id="editPartForm">
                <input type="hidden" id="editId" name="Id">
                <div class="modal-body">
                    <!-- Tab Navigation -->
                    <ul class="nav nav-tabs" id="editPartTabs" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active" id="edit-basic-tab" data-toggle="tab" href="#editBasicInfo" role="tab">
                                <i class="fas fa-info-circle"></i> Th√¥ng Tin C∆° B·∫£n
                                <span class="badge badge-danger ml-1">*</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="edit-classification-tab" data-toggle="tab" href="#editClassification" role="tab">
                                <i class="fas fa-shield-alt"></i> Ph√¢n Lo·∫°i & H√≥a ƒê∆°n
                                <span class="badge badge-warning ml-1">!</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="edit-technical-tab" data-toggle="tab" href="#editTechnical" role="tab">
                                <i class="fas fa-cogs"></i> Th√¥ng Tin K·ªπ Thu·∫≠t
                                <span class="badge badge-secondary ml-1">?</span>
                            </a>
                        </li>
                    </ul>

                    <!-- Tab Content -->
                    <div class="tab-content mt-3" id="editPartTabContent">
                        <!-- Tab 1: Th√¥ng Tin C∆° B·∫£n -->
                        <div class="tab-pane fade show active" id="editBasicInfo" role="tabpanel">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="editPartNumber">M√£ Ph·ª• T√πng <span class="text-danger">*</span></label>
                                        <input type="text" class="form-control form-control-sm" id="editPartNumber" name="PartNumber" required maxlength="50">
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="editPartName">T√™n Ph·ª• T√πng <span class="text-danger">*</span></label>
                                        <input type="text" class="form-control form-control-sm" id="editPartName" name="PartName" required maxlength="200">
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <label for="editDescription">M√¥ T·∫£</label>
                                        <textarea class="form-control form-control-sm" id="editDescription" name="Description" rows="2" maxlength="1000"></textarea>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="editSku">M√£ SKU</label>
                                        <input type="text" class="form-control form-control-sm" id="editSku" name="Sku" maxlength="100">
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="editBarcode">M√£ V·∫°ch / QR</label>
                                        <input type="text" class="form-control form-control-sm" id="editBarcode" name="Barcode" maxlength="150">
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="editCategory">Danh M·ª•c</label>
                                        <input type="text" class="form-control form-control-sm" id="editCategory" name="Category" maxlength="100">
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="editBrand">Th∆∞∆°ng Hi·ªáu</label>
                                        <input type="text" class="form-control form-control-sm" id="editBrand" name="Brand" maxlength="100">
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="editCostPrice">Gi√° V·ªën <span class="text-danger">*</span></label>
                                        <input type="text" class="form-control form-control-sm" id="editCostPrice" name="CostPrice" required>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="editSellPrice">Gi√° B√°n <span class="text-danger">*</span></label>
                                        <input type="text" class="form-control form-control-sm" id="editSellPrice" name="SellPrice" required>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label for="editQuantityInStock">S·ªë L∆∞·ª£ng T·ªìn <span class="text-danger">*</span></label>
                                        <input type="number" class="form-control form-control-sm" id="editQuantityInStock" name="QuantityInStock" required min="0">
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label for="editMinimumStock">T·ªìn Kho T·ªëi Thi·ªÉu</label>
                                        <input type="number" class="form-control form-control-sm" id="editMinimumStock" name="MinimumStock" min="0" data-title="M·ª©c t·ªìn kho t·ªëi thi·ªÉu ƒë·ªÉ c·∫£nh b√°o">
                                        <small class="form-text text-muted">H·ªá th·ªëng s·∫Ω c·∫£nh b√°o khi t·ªìn kho <= m·ª©c n√†y</small>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label for="editReorderLevel">M·ª©c T·ªìn B·ªï Sung</label>
                                        <input type="number" class="form-control form-control-sm" id="editReorderLevel" name="ReorderLevel" min="0" data-title="M·ª©c t·ªìn kho ƒë·ªÅ xu·∫•t ƒë·ªÉ ƒë·∫∑t h√†ng l·∫°i">
                                        <small class="form-text text-muted">G·ª£i √Ω s·ªë l∆∞·ª£ng c·∫ßn ƒë·∫∑t h√†ng (‚â• T·ªìn kho t·ªëi thi·ªÉu)</small>
                                    </div>
                                </div>
                        </div>
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label for="editDefaultUnit">ƒê∆°n V·ªã Ch√≠nh</label>
                                        <input type="text" class="form-control form-control-sm" id="editDefaultUnit" name="DefaultUnit" maxlength="20">
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="editWarehouseSelect">Kho l∆∞u tr·ªØ</label>
                                        <select class="form-control form-control-sm" id="editWarehouseSelect">
                                            <option value="">-- Ch·ªçn kho --</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="editWarehouseZoneSelect">Khu v·ª±c</label>
                                        <select class="form-control form-control-sm" id="editWarehouseZoneSelect" disabled>
                                            <option value="">-- Ch·ªçn khu v·ª±c --</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="editWarehouseBinSelect">K·ªá / NgƒÉn</label>
                                        <select class="form-control form-control-sm" id="editWarehouseBinSelect" disabled>
                                            <option value="">-- Ch·ªçn v·ªã tr√≠ --</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="editLocation">Ghi ch√∫ v·ªã tr√≠</label>
                                        <input type="text" class="form-control form-control-sm" id="editLocation" name="Location" maxlength="100">
                                        <small class="form-text text-muted">T·ª± ƒë·ªông c·∫≠p nh·∫≠t theo l·ª±a ch·ªçn kho, c√≥ th·ªÉ ch·ªânh tay.</small>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="editCompatibleVehicles">Xe T∆∞∆°ng Th√≠ch</label>
                                        <input type="text" class="form-control form-control-sm" id="editCompatibleVehicles" name="CompatibleVehicles" maxlength="500">
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="custom-control custom-checkbox">
                                        <input type="checkbox" class="custom-control-input" id="editIsActive" name="IsActive">
                                        <label class="custom-control-label" for="editIsActive">ƒêang Ho·∫°t ƒê·ªông</label>
                                    </div>
                                </div>
                            </div>

                            <hr>
                            <h6 class="text-primary"><i class="fas fa-random"></i> ƒê∆°n v·ªã quy ƒë·ªïi</h6>
                            <div class="table-responsive">
                                <table class="table table-sm table-bordered" id="editPartUnitsTable">
                                    <thead class="thead-light">
                                        <tr>
                                            <th>ƒê∆°n v·ªã</th>
                                            <th>H·ªá s·ªë</th>
                                            <th>M√£ v·∫°ch</th>
                                            <th>M·∫∑c ƒë·ªãnh</th>
                                            <th style="width: 40px;"></th>
                                        </tr>
                                    </thead>
                                    <tbody id="editPartUnitsTableBody">
                                        <tr class="text-muted">
                                            <td colspan="5" class="text-center">Nh·∫≠p th√¥ng tin b√™n d∆∞·ªõi ƒë·ªÉ b·ªï sung ƒë∆°n v·ªã.</td>
                                        </tr>
                                    </tbody>
                                    <tfoot class="bg-light">
                                        <tr>
                                            <td>
                                                <input type="text" class="form-control form-control-sm" id="editUnitNameInput" maxlength="50">
                                            </td>
                                            <td>
                                                <input type="number" class="form-control form-control-sm" id="editUnitConversionInput" min="0.0001" step="0.0001" value="1">
                                                <small class="text-muted d-block">1 ƒë∆°n v·ªã n√†y b·∫±ng bao nhi√™u ƒë∆°n v·ªã ch√≠nh</small>
                                            </td>
                                            <td>
                                                <input type="text" class="form-control form-control-sm" id="editUnitBarcodeInput" maxlength="150">
                                            </td>
                                            <td class="text-center">
                                                <div class="custom-control custom-checkbox mt-2">
                                                    <input type="checkbox" class="custom-control-input" id="editUnitIsDefaultInput">
                                                    <label class="custom-control-label" for="editUnitIsDefaultInput"></label>
                                                </div>
                                            </td>
                                            <td class="text-center">
                                                <button type="button" class="btn btn-sm btn-primary mb-1" id="btnEditSaveUnit" data-title="L∆∞u ƒë∆°n v·ªã">
                                                    <i class="fas fa-save"></i>
                                                </button>
                                                <button type="button" class="btn btn-sm btn-secondary mb-1 d-none" id="btnEditCancelEditUnit" data-title="H·ªßy ch·ªânh s·ª≠a">
                                                    <i class="fas fa-times"></i>
                                                </button>
                                            </td>
                                        </tr>
                                    </tfoot>
                                </table>
                                <input type="hidden" id="editUnitEditIndex" value="-1">
                            </div>
                        </div>

                        <!-- Tab 2: Ph√¢n Lo·∫°i & H√≥a ƒê∆°n -->
                        <div class="tab-pane fade" id="editClassification" role="tabpanel">
                            <!-- Quick Preset -->
                            <div class="alert alert-info">
                                <div class="row">
                                    <div class="col-md-9">
                                        <label><i class="fas fa-magic"></i> <strong>Ch·ªçn Nhanh Preset:</strong></label>
                                        <select class="form-control form-control-sm" id="editPresetSelect">
                                            <option value="">-- Gi·ªØ nguy√™n c√†i ƒë·∫∑t hi·ªán t·∫°i --</option>
                                            <option value="new_with_invoice">üìÑ Ph·ª• t√πng m·ªõi c√≥ h√≥a ƒë∆°n (C√¥ng ty/B·∫£o hi·ªÉm)</option>
                                            <option value="new_no_invoice">üì¶ Ph·ª• t√πng m·ªõi kh√¥ng h√≥a ƒë∆°n (C√° nh√¢n)</option>
                                            <option value="used_salvage">‚ôªÔ∏è Ph·ª• t√πng th√°o xe (C√° nh√¢n only)</option>
                                            <option value="oem_parts">‚≠ê Ph·ª• t√πng ch√≠nh h√£ng OEM</option>
                                            <option value="refurbished">üîÑ Ph·ª• t√πng t√°i ch·∫ø/T√¢n trang</option>
                                        </select>
                                    </div>
                                    <div class="col-md-3 text-right">
                                        <br>
                                        <button type="button" class="btn btn-sm btn-primary" id="editApplyPreset" data-title="√Åp d·ª•ng preset">
                                            <i class="fas fa-check"></i> √Åp d·ª•ng
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <hr>

                            <!-- Ngu·ªìn G·ªëc & T√¨nh Tr·∫°ng -->
                            <h6 class="text-primary"><i class="fas fa-box"></i> Ngu·ªìn G·ªëc & T√¨nh Tr·∫°ng</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="editSourceType">Ngu·ªìn G·ªëc</label>
                                        <select class="form-control form-control-sm" id="editSourceType" name="SourceType">
                                            <option value="Purchased">Mua m·ªõi</option>
                                            <option value="Used">Th√°o t·ª´ xe c≈©</option>
                                            <option value="Refurbished">T√°i ch·∫ø</option>
                                            <option value="Salvage">Ph·∫ø li·ªáu</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="editCondition">T√¨nh Tr·∫°ng</label>
                                        <select class="form-control form-control-sm" id="editCondition" name="Condition">
                                            <option value="New">M·ªõi 100%</option>
                                            <option value="Used">ƒê√£ qua s·ª≠ d·ª•ng</option>
                                            <option value="Refurbished">T√°i ch·∫ø</option>
                                            <option value="AsIs">Nguy√™n tr·∫°ng</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <label for="editSourceReference">Chi Ti·∫øt Ngu·ªìn G·ªëc</label>
                                        <input type="text" class="form-control form-control-sm" id="editSourceReference" name="SourceReference" maxlength="100" placeholder="VD: Th√°o t·ª´ xe 30A-12345">
                                    </div>
                                </div>
                            </div>

                            <hr>

                            <!-- Qu·∫£n L√Ω H√≥a ƒê∆°n -->
                            <h6 class="text-primary"><i class="fas fa-file-invoice"></i> Qu·∫£n L√Ω H√≥a ƒê∆°n</h6>
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label for="editInvoiceType">Lo·∫°i H√≥a ƒê∆°n</label>
                                        <select class="form-control form-control-sm" id="editInvoiceType" name="InvoiceType">
                                            <option value="WithInvoice">C√≥ h√≥a ƒë∆°n VAT</option>
                                            <option value="WithoutInvoice">Kh√¥ng h√≥a ƒë∆°n</option>
                                            <option value="Internal">N·ªôi b·ªô</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label for="editVATRate">Thu·∫ø VAT (%)</label>
                                        <select class="form-control form-control-sm" id="editVATRate" name="VATRate">
                                            <option value="0">Kh√¥ng VAT (0%)</option>
                                            <option value="8">VAT 8%</option>
                                            <option value="10">VAT 10%</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <br>
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="custom-control-input" id="editIsVATApplicable" name="IsVATApplicable">
                                            <label class="custom-control-label" for="editIsVATApplicable">
                                                <strong>√Åp d·ª•ng thu·∫ø VAT</strong>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <hr>

                            <!-- ƒê·ªëi T∆∞·ª£ng S·ª≠ D·ª•ng -->
                            <h6 class="text-primary"><i class="fas fa-users"></i> ƒê·ªëi T∆∞·ª£ng S·ª≠ D·ª•ng</h6>
                            <div class="alert alert-warning">
                                <i class="fas fa-exclamation-triangle"></i> <strong>L∆∞u √Ω:</strong> C√¥ng ty v√† B·∫£o hi·ªÉm ch·ªâ ch·∫•p nh·∫≠n ph·ª• t√πng c√≥ h√≥a ƒë∆°n VAT h·ª£p l·ªá
                            </div>
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="custom-control custom-checkbox">
                                        <input type="checkbox" class="custom-control-input" id="editCanUseForIndividual" name="CanUseForIndividual">
                                        <label class="custom-control-label" for="editCanUseForIndividual">
                                            <i class="fas fa-user"></i> <strong>C√° nh√¢n</strong>
                                            <br><small class="text-muted">Lu√¥n ƒë∆∞·ª£c ph√©p</small>
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="custom-control custom-checkbox">
                                        <input type="checkbox" class="custom-control-input" id="editCanUseForCompany" name="CanUseForCompany">
                                        <label class="custom-control-label" for="editCanUseForCompany">
                                            <i class="fas fa-building"></i> <strong>C√¥ng ty</strong>
                                            <br><small class="text-danger">‚ö†Ô∏è Y√™u c·∫ßu c√≥ h√≥a ƒë∆°n</small>
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="custom-control custom-checkbox">
                                        <input type="checkbox" class="custom-control-input" id="editCanUseForInsurance" name="CanUseForInsurance">
                                        <label class="custom-control-label" for="editCanUseForInsurance">
                                            <i class="fas fa-shield-alt"></i> <strong>B·∫£o hi·ªÉm</strong>
                                            <br><small class="text-danger">‚ö†Ô∏è Y√™u c·∫ßu c√≥ h√≥a ƒë∆°n</small>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <hr>

                            <!-- B·∫£o H√†nh -->
                            <h6 class="text-primary"><i class="fas fa-shield-check"></i> B·∫£o H√†nh</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="editWarrantyMonths">Th·ªùi Gian B·∫£o H√†nh (th√°ng)</label>
                                        <input type="number" class="form-control form-control-sm" id="editWarrantyMonths" name="WarrantyMonths" min="0" max="120">
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <br>
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="custom-control-input" id="editIsOEM" name="IsOEM">
                                            <label class="custom-control-label" for="editIsOEM">
                                                <i class="fas fa-star text-warning"></i> <strong>Ph·ª• t√πng ch√≠nh h√£ng (OEM)</strong>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <hr>

                            <!-- Classification Summary -->
                            <div id="editClassificationSummary"></div>
                        </div>

                        <!-- Tab 3: Th√¥ng Tin K·ªπ Thu·∫≠t -->
                        <div class="tab-pane fade" id="editTechnical" role="tabpanel">
                            <h6 class="text-primary"><i class="fas fa-barcode"></i> M√£ Ph·ª• T√πng</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="editOEMNumber">M√£ OEM (Ch√≠nh h√£ng)</label>
                                        <input type="text" class="form-control form-control-sm" id="editOEMNumber" name="OEMNumber" maxlength="50">
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="editAftermarketNumber">M√£ Aftermarket (Thay th·∫ø)</label>
                                        <input type="text" class="form-control form-control-sm" id="editAftermarketNumber" name="AftermarketNumber" maxlength="50">
                                    </div>
                                </div>
                            </div>

                            <hr>

                            <h6 class="text-primary"><i class="fas fa-industry"></i> Nh√† S·∫£n Xu·∫•t</h6>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <label for="editManufacturer">Nh√† S·∫£n Xu·∫•t</label>
                                        <input type="text" class="form-control form-control-sm" id="editManufacturer" name="Manufacturer" maxlength="100">
                                    </div>
                                </div>
                            </div>

                            <hr>

                            <h6 class="text-primary"><i class="fas fa-ruler-combined"></i> Th√¥ng S·ªë K·ªπ Thu·∫≠t</h6>
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label for="editDimensions">K√≠ch Th∆∞·ªõc</label>
                                        <input type="text" class="form-control form-control-sm" id="editDimensions" name="Dimensions" maxlength="100" placeholder="VD: 120x80x25mm">
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label for="editWeight">Tr·ªçng L∆∞·ª£ng (kg)</label>
                                        <input type="number" class="form-control form-control-sm" id="editWeight" name="Weight" min="0" step="0.01">
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label for="editMaterial">Ch·∫•t Li·ªáu</label>
                                        <input type="text" class="form-control form-control-sm" id="editMaterial" name="Material" maxlength="50">
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="editColor">M√†u S·∫Øc</label>
                                        <input type="text" class="form-control form-control-sm" id="editColor" name="Color" maxlength="50">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-sm btn-secondary" data-dismiss="modal" data-title="ƒê√≥ng">
                        <i class="fas fa-times"></i> H·ªßy
                    </button>
                    <button type="submit" class="btn btn-sm btn-info" data-title="L∆∞u c·∫≠p nh·∫≠t">
                        <i class="fas fa-save"></i> C·∫≠p Nh·∫≠t
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
